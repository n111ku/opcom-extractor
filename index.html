<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OPCOM Script Generator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header">
    <h1 class="title">OPCOM Console Script Generator</h1>

    <button id="howToBtn" class="help-btn" aria-label="How to use this tool" title="How to use">
      ?
    </button>
  </header>

  <section class="card">
    <div class="row">
      <label class="field">
        <span>Start date</span>
        <input type="date" id="start" />
      </label>

      <label class="field">
        <span>End date</span>
        <input type="date" id="end" />
      </label>
    </div>

    <div class="row">
      <label class="check">
        <input type="checkbox" id="normalizeData" checked />
        Normalize 15-minute data (96 intervals) to hourly (mean of 4)
      </label>
    </div>

    <div class="grid">
      <label class="check"><input type="checkbox" id="all" checked /> Export all data (original layout)</label>
      <label class="check"><input type="checkbox" id="price" checked /> Export price (transposed)</label>
      <label class="check"><input type="checkbox" id="volume" checked /> Export volume (transposed)</label>
      <label class="check"><input type="checkbox" id="buy" checked /> Export buy volume (transposed)</label>
      <label class="check"><input type="checkbox" id="sell" checked /> Export sell volume (transposed)</label>
    </div>

    <div class="actions">
      <button id="generate" class="primary">Generate & Copy Script</button>
    </div>

    <label class="field">
      <span>Generated script (auto-copied)</span>
      <textarea id="output" readonly spellcheck="false"></textarea>
    </label>
  </section>

  <!-- How-to modal -->
  <div id="howToModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="howToTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="howToTitle">How to use</h2>
        <button id="closeHowTo" class="icon-btn" aria-label="Close">✕</button>
      </div>

      <ol class="howto">
        <li>Select <b>Start</b> and <b>End</b> date.</li>
        <li>(Optional) Keep <b>Normalize</b> enabled to convert 96×15min → 24×hour.</li>
        <li>Select export files you want.</li>
        <li>Click <b>Generate & Copy Script</b>.</li>
        <li>Open the OPCOM page in a new tab:
          <div class="mono">https://www.opcom.ro/grafice-ip-raportPIP-si-volumTranzactionat/ro</div>
        </li>
        <li>Open DevTools (F12) → <b>Console</b>.</li>
        <li>Paste the script and press Enter.</li>
        <li>Wait. CSVs will download automatically.</li>
      </ol>

      <p class="note">
        Tip: Don’t run multiple times in parallel. The script already throttles requests (400ms).
      </p>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
