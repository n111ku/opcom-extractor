<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OPCOM Script Generator</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div style="display:flex; flex-direction:row;gap:1rem;align-items:center;">
<h1>OPCOM Console Script Generator</h1>
  
<button id="howToBtn" class="help-btn" aria-label="How to use this tool">
  ?
</button>
  
</div>

<label>
  Start date:
  <input type="date" id="start">
</label>

<label>
  End date:
  <input type="date" id="end">
</label>

<h3>Export options</h3>

<label><input type="checkbox" id="all" checked> Export all data</label><br>
<label><input type="checkbox" id="price" checked> Export price</label><br>
<label><input type="checkbox" id="volume" checked> Export volume</label><br>
<label><input type="checkbox" id="buy" checked> Export buy volume</label><br>
<label><input type="checkbox" id="sell" checked> Export sell volume</label><br>
<label>
  <input type="checkbox" id="normalizeData" checked />
  Normalize 15-minute data to hourly (mean)
</label>
<br>
<button id="generate">Generate Script</button>

<textarea id="output" readonly></textarea>



  <div id="howToModal" class="modal hidden">
  <div class="modal-content">
    <h2>How to use the OPCOM Script Generator</h2>

    <ol>
      <li>
        Select <strong>Start date</strong> and <strong>End date</strong>.
      </li>
      <li>
        Choose which CSV files you want to export.
      </li>
      <li>
        Click <strong>Generate Script</strong>.
        The script is automatically copied to your clipboard.
      </li>
      <li>
        Open
        <a href="https://www.opcom.ro/grafice-ip-raportPIP-si-volumTranzactionat/ro"
           target="_blank" rel="noopener">
          the OPCOM page
        </a>.
      </li>
      <li>
        Press <strong>F12</strong> to open Developer Tools.
      </li>
      <li>
        Go to the <strong>Console</strong> tab.
      </li>
      <li>
        Paste the script and press <strong>Enter</strong>.
      </li>
      <li>
        Wait until the script finishes.
        CSV files will download automatically.
      </li>
    </ol>

    <p class="note">
      ⚠️ Do not open multiple tabs or run the script repeatedly in a short time.
    </p>

    <button id="closeHowTo">Close</button>
  </div>
</div>
<script src="app.js"></script>
</body>
</html>
